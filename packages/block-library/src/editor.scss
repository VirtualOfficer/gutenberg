@import "./archives/editor.scss";
@import "./audio/editor.scss";
@import "./button/editor.scss";
@import "./categories/editor.scss";
@import "./code/editor.scss";
@import "./columns/editor.scss";
@import "./cover/editor.scss";
@import "./embed/editor.scss";
@import "./file/editor.scss";
@import "./classic/editor.scss";
@import "./gallery/editor.scss";
@import "./group/editor.scss";
@import "./html/editor.scss";
@import "./image/editor.scss";
@import "./latest-comments/editor.scss";
@import "./latest-posts/editor.scss";
@import "./legacy-widget/editor.scss";
@import "./media-text/editor.scss";
@import "./list/editor.scss";
@import "./more/editor.scss";
@import "./nextpage/editor.scss";
@import "./paragraph/editor.scss";
@import "./preformatted/editor.scss";
@import "./pullquote/editor.scss";
@import "./quote/editor.scss";
@import "./rss/editor.scss";
@import "./search/editor.scss";
@import "./shortcode/editor.scss";
@import "./spacer/editor.scss";
@import "./subhead/editor.scss";
@import "./table/editor.scss";
@import "./tag-cloud/editor.scss";
@import "./text-columns/editor.scss";
@import "./verse/editor.scss";
@import "./video/editor.scss";

/**
 * Editor Normalization Styles
 *
 * These are only output in the editor, but styles here are NOT prefixed .editor-styles-wrapper.
 * This allows us to create normalization styles that are easily overridden by editor styles.
 */

// Reset class selectors that are used on HTML elements.
// Raise the specificity to keep theme styles from overriding.
// Specificity = 030.
:root .editor-styles-wrapper .editor-post-permalink__link,
:root .editor-styles-wrapper .components-tab-button,
:root .editor-styles-wrapper .block-editor-url-input > input,
:root .editor-styles-wrapper .dashicon,
:root .editor-styles-wrapper .components-button,
:root .editor-styles-wrapper .components-dropdown-menu__indicator,
:root .editor-styles-wrapper .block-editor-block-icon {
	all: unset;
	box-sizing: inherit;
}

// Provide every block with a default base margin. This margin provides a consistent spacing
// between blocks in the editor.
[data-block] {
	margin-top: $default-block-margin;
	margin-bottom: $default-block-margin;
}

// Some components get styled in block-library/ and miss our specificity prefixing.
// They probably shouldn't. This is temporary for testing.
:root:root:root {
	// packages/block-library/src/gallery/editor.scss
	.blocks-gallery-item {
		// Hide the focus outline that otherwise briefly appears when selecting a block.
		figure:not(.is-selected):focus {
			outline: none;
		}

		.is-selected {
			outline: 4px solid theme(primary);
		}

		.is-transient img {
			opacity: 0.3;
		}

		.block-editor-rich-text {
			position: absolute;
			bottom: 0;
			width: 100%;
			max-height: 100%;
			overflow-y: auto;
		}

		.block-editor-rich-text figcaption:not([data-is-placeholder-visible="true"]) {
			position: relative;
			overflow: hidden;
		}

		.is-selected .block-editor-rich-text {
			// IE calculates this incorrectly, so leave it to modern browsers.
			@supports (position: sticky) {
				right: 0;
				left: 0;
				margin-top: -4px;
			}

			// Override negative margins so this toolbar isn't hidden by overflow. Overflow is needed for long captions.
			.block-editor-rich-text__inline-toolbar {
				top: 0;
			}

			// Make extra space for the inline toolbar.
			figcaption {
				padding-top: 48px;
			}
		}

		.block-editor-rich-text figcaption {
			a {
				color: $white;
			}
		}
	}

	.block-library-gallery-item__inline-menu .components-button {
		color: $white;
		&:hover,
		&:focus {
			color: $white;
		}
	}

	.blocks-gallery-item__remove {
		padding: 0;

		&.components-button:focus {
			color: inherit;
		}
	}

	// packages/block-library/src/cover/editor.scss
	.wp-block-cover .block-editor-block-list__block {
		color: $light-gray-100;
	}

	// packages/block-library/src/code/editor.scss
	.components-tab-button {
		display: inline-flex;
		align-items: flex-end;
		margin: 0;
		padding: 3px;
		background: none;
		outline: none;
		color: $dark-gray-500;
		cursor: pointer;
		position: relative;
		height: $icon-button-size;
		font-family: $default-font;
		font-size: $default-font-size;
		font-weight: 500;
		border: 0;

		&.is-active,
		&.is-active:hover {
			color: $white;
		}

		&:disabled {
			cursor: default;
		}

		& > span {
			border: $border-width solid transparent;
			padding: 0 6px;
			box-sizing: content-box;
			height: 28px;
			line-height: 28px;
		}

		&:hover > span,
		&:focus > span {
			color: $dark-gray-500;
		}

		&:not(:disabled) {
			&.is-active > span,
			&:hover > span,
			&:focus > span {
				border: $border-width solid $dark-gray-500;
			}
		}

		&.is-active > span,
		&.is-active:hover > span {
			background-color: $dark-gray-500;
			color: $white;
		}
	}

	// packages/block-library/src/image/editor.scss
	// Ensure the resize handles are visible when the image is focused.
	.wp-block-image.is-focused .components-resizable-box__handle {
		display: block;
		z-index: z-index(".block-library-image__resize-handlers");
	}

	// packages/block-library/src/button/editor.scss
	.block-library-button__inline-link {
		background: $white;
		display: flex;
		flex-wrap: wrap;
		align-items: center;
		font-family: $default-font;
		font-size: $default-font-size;
		line-height: $default-line-height;

		// The width of input box plus padding plus two icon buttons.
		$blocks-button__link-input-width: 300px + 2px + 2 * $icon-button-size;
		width: $blocks-button__link-input-width;

		// Move it down by 2px so that it doesn't overlap the button focus outline.
		margin-top: 2px;

		.block-editor-url-input {
			width: auto;
		}

		.block-editor-url-input__suggestions {
			width: $blocks-button__link-input-width - $icon-button-size - $icon-button-size;
			z-index: z-index(".block-library-button__inline-link .block-editor-url-input__suggestions");
		}

		> .dashicon {
			width: $icon-button-size;

			// adds the inline height back, after reset.
			height: 20px;
		}

		.dashicon {
			color: $dark-gray-100;
		}

		.block-editor-url-input input[type="text"]::placeholder {
			color: $dark-gray-100;
		}
	}

	[data-align="center"] .block-library-button__inline-link {
		margin-left: auto;
		margin-right: auto;
	}

	[data-align="right"] .block-library-button__inline-link {
		margin-left: auto;
		margin-right: 0;
	}
}
